<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Handelsimperium & Politik</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #e67e22;
            --bg: #f4f7f6;
            --card: #ffffff;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); margin: 0; padding: 20px; }
        header { background: var(--primary); color: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        
        nav { display: flex; gap: 10px; margin-bottom: 20px; }
        nav button { padding: 10px 20px; cursor: pointer; border: none; background: #ddd; border-radius: 5px; font-weight: bold; transition: 0.3s; }
        nav button:hover { background: #ccc; }
        nav button.active { background: var(--accent); color: white; }

        .container { display: grid; grid-template-columns: 300px 1fr; gap: 20px; }
        .sidebar { background: var(--card); padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); height: fit-content; }
        .main-content { background: var(--card); padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

        .schiff-karte, .gebaeude-karte { border: 1px solid #eee; padding: 15px; margin-bottom: 10px; border-radius: 8px; background: #fafafa; }
        .kaufen-button { background: #27ae60; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; }
        .kaufen-button:disabled { background: #95a5a6; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { text-align: left; padding: 12px; border-bottom: 1px solid #eee; }
        tr:hover { background: #f9f9f9; }

        .einfluss-info { color: #2980b9; font-weight: bold; font-size: 0.9em; }
    </style>
</head>
<body>

<header>
    <div id="spieler-info">
        <strong id="spieler-name">Kapitän</strong> | 
        Gold: <span id="gold-wert">1000</span> | 
        Tag: <span id="tag-wert">1</span>
    </div>
    <button onclick="naechsterTag()" style="background: var(--accent); color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">Nächster Tag</button>
</header>

<nav>
    <button onclick="zeigeMenue('uebersicht')" id="nav-uebersicht">Übersicht</button>
    <button onclick="zeigeMenue('handel')" id="nav-handel">Handel</button>
    <button onclick="zeigeMenue('schiffe')" id="nav-schiffe">Flotte</button>
</nav>

<div class="container">
    <div class="sidebar">
        <h3>Städte-Auswahl</h3>
        <div id="staedte-liste"></div>
    </div>

    <div class="main-content" id="inhalt">
        </div>
</div>

<script>
// --- SPIEL-DATEN ---
const SPIELER_DATEN = {
    gold: 1500,
    tag: 1,
    aktuelleStadt: "Aethelgard",
    inventar: { "Getreide": 10, "Holz": 5 },
    einfluss: { "Aethelgard": 0, "Port Valerius": 0 },
    schiffeBesitz: [
        { name: "Die flinke Krabbe", typ: "Kogge", ort: "Aethelgard", status: "liegt vor Anker", kapazitaet: 20 }
    ]
};

const STAEDTE = {
    "Aethelgard": { einwohner: 1200, versorgung: "Gut", verbindungen: ["Port Valerius", "Tortuga"], gueter: { "Getreide": 20, "Holz": 50 } },
    "Port Valerius": { einwohner: 800, versorgung: "Knapp", verbindungen: ["Aethelgard"], gueter: { "Getreide": 5, "Stahl": 15 } },
    "Tortuga": { einwohner: 300, versorgung: "Mäßig", verbindungen: ["Aethelgard"], gueter: { "Rum": 100 } }
};

const SCHIFFS_TYPEN = [
    { name: "Kogge", preis: 500, kapazitaet: 20, geschwindigkeit: 1 },
    { name: "Karavelle", preis: 1200, kapazitaet: 50, geschwindigkeit: 1.5 }
];

// --- LOGIK ---

function starteSpiel() {
    erstelleStaedteListe();
    zeigeMenue('uebersicht');
    aktualisiereStatus();
}

function erstelleStaedteListe() {
    const liste = document.getElementById('staedte-liste');
    liste.innerHTML = "";
    for (let stadt in STAEDTE) {
        let btn = document.createElement('button');
        btn.innerText = stadt;
        btn.style.width = "100%";
        btn.style.marginBottom = "5px";
        btn.onclick = () => { SPIELER_DATEN.aktuelleStadt = stadt; starteSpiel(); };
        liste.appendChild(btn);
    }
}

function aktualisiereStatus() {
    document.getElementById('gold-wert').innerText = SPIELER_DATEN.gold;
    document.getElementById('tag-wert').innerText = SPIELER_DATEN.tag;
}

function berechnePreis(stadt, ware, aktion) {
    let basis = 20; // Vereinfacht
    let punkte = SPIELER_DATEN.einfluss[stadt] || 0;
    let bonus = punkte >= 500 ? 0.10 : (punkte >= 100 ? 0.05 : 0);
    
    return aktion === 'kaufen' ? Math.round(basis * (1 - bonus)) : Math.round(basis * (1 + bonus));
}

function zeigeMenue(punkt) {
    const inhalt = document.getElementById('inhalt');
    // Navigation hervorheben
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    document.getElementById('nav-' + punkt).classList.add('active');

    let html = "";
    const stadt = SPIELER_DATEN.aktuelleStadt;
    const schiffHier = SPIELER_DATEN.schiffeBesitz.find(s => s.ort === stadt && s.status === 'liegt vor Anker');

    if (punkt === 'uebersicht') {
        let punkte = SPIELER_DATEN.einfluss[stadt] || 0;
        html = `<h2>Willkommen in ${stadt}</h2>
                <p>Status: ${STAEDTE[stadt].versorgung}</p>
                <div class="einfluss-info">Politischer Einfluss: ${punkte} Punkte</div>
                <p>${schiffHier ? "✅ Eines deiner Schiffe liegt hier im Hafen." : "❌ Kein Schiff vor Ort. Handel nicht möglich."}</p>`;
    } 
    
    else if (punkt === 'handel') {
        if (!schiffHier) {
            html = "<h3>Handel blockiert</h3><p>Du musst erst ein Schiff nach " + stadt + " steuern.</p>";
        } else {
            html = `<h2>Handel in ${stadt}</h2><table><tr><th>Ware</th><th>Preis</th><th>Aktion</th></tr>`;
            ["Getreide", "Holz", "Stahl"].forEach(ware => {
                let pKauf = berechnePreis(stadt, ware, 'kaufen');
                html += `<tr><td>${ware}</td><td>${pKauf} Gold</td>
                         <td><button onclick="handel('${ware}', 'kaufen', ${pKauf})">Kaufen</button></td></tr>`;
            });
            html += "</table>";
        }
    }

    else if (punkt === 'schiffe') {
        html = "<h2>Deine Flottenverwaltung</h2>";
        SPIELER_DATEN.schiffeBesitz.forEach((s, idx) => {
            html += `<div class="schiff-karte">
                <strong>${s.name}</strong> (${s.typ})<br>
                Ort: ${s.ort} | Status: ${s.status}<br>
                Reiseziel: <select id="ziel-${idx}">
                    <option value="">Wählen...</option>
                    ${STAEDTE[s.ort].verbindungen.map(v => `<option value="${v}">${v}</option>`).join('')}
                </select>
                <button onclick="sendeSchiff(${idx})">Senden</button>
            </div>`;
        });
    }

    inhalt.innerHTML = html;
}

function handel(ware, aktion, preis) {
    if (aktion === 'kaufen' && SPIELER_DATEN.gold >= preis) {
        SPIELER_DATEN.gold -= preis;
        SPIELER_DATEN.inventar[ware] = (SPIELER_DATEN.inventar[ware] || 0) + 1;
        // Beim Handel Einfluss gewinnen
        SPIELER_DATEN.einfluss[SPIELER_DATEN.aktuelleStadt] += 2;
        alert(ware + " gekauft! Einfluss steigt.");
    }
    aktualisiereStatus();
    zeigeMenue('handel');
}

function sendeSchiff(idx) {
    const ziel = document.getElementById(`ziel-${idx}`).value;
    if (!ziel) return;
    const schiff = SPIELER_DATEN.schiffeBesitz[idx];
    schiff.status = "unterwegs";
    schiff.ort = ziel; // Vereinfacht: Sofortige Ankunft für Demo
    setTimeout(() => { 
        schiff.status = "liegt vor Anker"; 
        alert(schiff.name + " ist in " + ziel + " angekommen!");
        zeigeMenue('schiffe');
    }, 2000);
    zeigeMenue('schiffe');
}

function naechsterTag() {
    SPIELER_DATEN.tag++;
    // Zufälliges Event bei hohem Einfluss
    for(let stadt in SPIELER_DATEN.einfluss) {
        if(SPIELER_DATEN.einfluss[stadt] > 50 && Math.random() > 0.8) {
            alert("EVENT: Die Bürger von " + stadt + " danken dir für deine treuen Dienste mit 50 Gold!");
            SPIELER_DATEN.gold += 50;
        }
    }
    aktualisiereStatus();
}

// Start
starteSpiel();

</script>
</body>
</html>
